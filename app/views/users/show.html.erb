<div class="whole_wrap">

<% if current_user?(@user) %>
  <div class="body_wrap"></div>
  <div class="aside__menu">
    <ul class="aside__menu_lists">
      <li class="aside__menu_list">閉じる</li>
      <li class="aside__menu_list"><%= link_to "プロフィール編集", [:edit, @user] %></li>
      <li class="aside__menu_list"><%= link_to "新規サークル登録", [:new, :circle], class: "create_circle_btn"%></li>
      <li class="aside__menu_list"><%= link_to "ログアウト", [:destroy, :user, :session], method: :delete, data: { confirm: "ログアウトしますか？" } %></li>
      <li class="aside__menu_list"><%= link_to "アカウントを削除", @user, method: :delete %></li>
    </ul>
  </div>
<% end %>

<header class="header">
  <div class="header__background" style="background-image: url(<%= @user.header_picture %>)"></div>
  <div class="header__photo_user" style="background-image: url(<%= @user.picture %>);"></div>
  <h1 class="header__name_user"><%= @user.name %></h1>
  <p class="header__subhead_user"><%= @user.college %>/<%= @user.department %>/<%= @user.grade %>年</p>
  <% if current_user?(@user) %>
    <%= image_tag "menu.svg" , class: "header__menu_humberger" %>
    <% if @user.circles.any? %>
      <div class="header__foot">
        <%= link_to image_tag("foot.png"), [:foots, @user], class: "foot" %>
        <% if user_signed_in? && current_user.new_foots_count && 0 < current_user.new_foots_count %>
          <div class="header__notice"><%= current_user.new_foots_count %></div>
        <% end %>
      </div>
    <% end %>
  <% end %>
  <div class="message_follow">
    <% if user_signed_in? && !current_user?(@user) %>
      <div id="follow_form">
        <%= render !current_user.following?(@user) ? "follow" : "unfollow" %>
      </div>
      <% if current_user.mutual_follow?(@user) %>
        <%= link_to image_tag("message_blue.svg"), [:new, :message_room, user_id: @user.id], class: "header__message" %>
      <% else %>
        <%= image_tag("message_blue.svg", class: "header__message") %>
      <% end %>
    <% end %>
  </div>
</header>

<div class="follow">
  <ul class="follow__wrap">
    <li class="follow__list follow__list_border_right">
      <%= link_to [:following, @user] , class: "follow__link" do %>
        <div id="following_count" class="follow__number" ><%= @user.following.count %></div>フォロー
      <% end %>
    </li>
    <li class="follow__list follow__list_border_right">
      <%= link_to [:followers, @user] , class: "follow__link" do %>
        <div id="followers_count" class="follow__number" ><%= @user.followers.count %></div>フォロワー
      <% end %>
    </li>
    <li class="follow__list">
      <%= link_to [:favorites, @user] , class: "follow__link" do %>
        <div id="favorites_count" class="follow__number" ><%= @user.favorites.count %></div>気になる
      <% end %>
    </li>
  </ul>
</div>

<!-- 入ってるサークルの情報 -->
<section class="frame">
  <% if @user.circles.any? %>
    <div class="frame__heading">所属サークル</div>
  <% end %>
  <% @user.circles.each do |circle| %>
    <div class="belong">
      <%= link_to circle do %>
        <div class="belong__image c_pict" style="background-image: url(<%= circle.picture %>)"></div>
        <div class="belong__heading"><%= circle.name %></div>
        <div class="belong__description"><%= circle.description %></div>
      <% end %>
    </div>
  <% end %>
</section>

<section class="user__body">

  <% @profiles.each do |key, value| %>
    <div class="introduce">
      <h1 class="introduce__heading"><%= value %></h1>
      <% if key != :categories %>
        <p class="introduce__text"><%= simple_format(h(@user[key])) %></p>
      <% else %>
        <% @user.categories.each do |category| %>
          <p class="introduce__text"><%= category.name %></p>
        <% end %>
      <% end %>
      <% if current_user?(@user) %>
        <div class="introduce__btn">
          <%= link_to '編集', [:edit, @user, edit_item: key], class: "button button_size_small button_color_white" %>
        </div>
      <% end %>
    </div>
  <% end %>

</section>

</div>